----------------------------------------------------------------------------------------------------------------------------------------
# Test Assignment

1. Explore the actual behavior of the application manually - using `curl` or `Postman` or any other tool.

->	Using Postman I checked manually the behavior of the application testing each request with some different values to see what is the behavior. I found some bugs
	regarding the expected behavior on the design documentation. 

2. Design a test strategy for the application, create a checklist of potential test cases and prioritize them.


->	After analysing the specification in the design I defined what should be the basic flow for the application and with that I determined a test
	strategy with test cases
	
	- User should be able to create a payment and with that check that the payment was created as expected
	- User should be able to process all payments expecting as result all payments being converted to EUR
	- User should be able to delete a specific payment
	
	The test cases should at least cover these basic behavior

	Test Cases Output Expected: 
			    GET - Check with admin , john , unknown .   Should return 200 or 403 for unknown
			    PUT - Check with admin , john , unknown . 
			          Check inserting currency with different size than 3	
			    POST - Check permition only for admin
			          Check convertion of each currency (expected to see completed 1 )
				  Check if no convertion needed (expected to see completed 0 )
			    DELETE - Check permition admin/user
				  Delete a payment and check that it was deleted as expected - Done
						
						 
	Test Plan Manual for basic flow:
	
	-Create a payment
		When i request to create a payment
		Then the payment should be created
		
	-Retrive all payments
		When i request to retrive the payments
		Then the payments should be retrived
	
	-Process all payments
		Given i have payments
		When i request to process all payments
		Then all the payments should be processed
		
	-Delete specific payment as admin
		Given i have payments
		When i request to delete a payment
		Then the payment should be deleted	
		
	In automation test cases I covered more specific cases as well
	

3. Automate test cases - in Python: create test libraries, in Robot Framework: import these libraries and create test suites and test cases. -> Done

   _Note_: after each test consider to return the test target (app, data) into the same state. -> Done (Test Teardown   Restore Database)

4. Execute test cases locally from RIDE (https://github.com/robotframework/RIDE) and from a docker container. -> See the DockerFile

	-> You can execute manually as well the test cases using the following command in the folder (NN\test_cases):  robot -d result *.robot
	-> Libraries necessary: Collections, RequestsLibrary, RequestsChecker, json requests and Process (Can be installed manually using  pip install robotframework-%libraryname%

5. Provide a test report generated by Robot Framework. What issues have been discovered and what defects would you submit?

->      Test report in results_report folder on \ or in the \test_cases\results
	
->	The following defects were found executing the automation and doing manual test and should be fixed for the correct behavior of the app regarding the design documentation:
	
->	BUG: Country code is not being limited by 3 digits ( expected 400 status code Bad Request regarding rfc 4918.) - Priority Medium

->	BUG: Common user should not be able to delete any payment - Priority High

->	BUG: Common user should not be able to POST(process) payment - Priority High 

->	BUG: USD currency not being processed  - Priority Highest

->	BUG: Currency convertion not doing the right calculation- Convertion for GBP is using 0.84 but it should use 0.89 - Priority Highest
	
	Note that when executing the automation we have as result 8 critical test, 4 passed, 4 failed .  4 failed tests were the tests that I analised why failed
	and then I found the bugs.
	
6. The application uses SQLite database, but what will change in your code if it gets replaced with MySQL or MS SQL or Oracle?

->	If the database changed to MySql or Oracle for example I would have to pay more attention to the rest request methods since this database has better authentication compared to SQLite. So I would perform the rest calls after passing a specific authentication
        The calls and connection to the database would be different and I would use another robot library

7. What would you improve in your approach and code if you have more time?

->	-If I had more time I would work with more variables and with that I would decrease the code size by reusing keywords in other tests
	-I would store the input jsons in a separate file and I would use them dynamically as well, ie changing the values depending on each test
	-I would improve TearDown perhaps by directly cleaning the database with SQL code since the teardown that I implemented can take a while depending on the amount of data


------------------------------------------------------------------------------------------------------------------------------------------------------------

# App Design Documentation

The application displays a welcome page which shows a greeting
and implements an API `/finance/api/v1.0/payments` which supports below methods:

1. `GET /finance/api/v1.0/payments` - to retrieve all the payments from SQLite database as a list (allowed for admins only).

1. `PUT /finance/api/v1.0/payments` with json data in this form `{"purchase": <integer>, "amount": <float>, "currency": "<str>"}` where currency code is a 3-letter captalized string (e.g. `GBP`, `USD`, `EUR`) - to create a payment entry in the database (allowed for authorized users).

1. `POST /finance/api/v1.0/payments` - process all payments, where `completed` is still `0`: change the currency to `EUR` (convert amount to `EUR` according to the rates in the currency table) and set `completed` to `1` (allowed for admins only).

1. `DELETE /finance/api/v1.0/payments/<payment_id>` - to remove the payment by the given `payment_id` (allowed for admins to remove any payment and for the users to remove only their payments).

_Notes_:
* Currently, two users are registered in the system: `admin/admin` and `john/john`.
* At present time the application supports basic authentication only.

# Deployment Instructions

Start the web application - in a terminal window, execute `python app.py`.

_Note_: you will need to install necessary Python dependencies.
